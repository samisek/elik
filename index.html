<!DOCTYPE html>
<html lang="cs">
<head>
<meta charset="UTF-8">
<title>Pro El√≠ka</title>
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<style>
body {
    margin: 0;
    font-family: Arial, sans-serif;
    background: linear-gradient(135deg, #ff9a9e, #fad0c4);
    display: flex;
    flex-direction: column;
    align-items: center;
    justify-content: center;
    min-height: 100vh;
    position: relative;
}

/* Popup */
.popup {
    background: white;
    padding: 25px 35px;
    border-radius: 18px;
    text-align: center;
    box-shadow: 0 10px 30px rgba(0,0,0,0.25);
    max-width: 340px;
    z-index: 10;
    position: absolute;
    top: 40%;
}

.popup p {
    font-size: 22px;
}

button {
    padding: 16px 28px;
    font-size: 20px;
    border: none;
    border-radius: 12px;
    cursor: pointer;
    background-color: #ff4d6d;
    color: white;
    margin-top: 15px;
}

/* GIF pod popupem */
#introGif {
    margin-top: 20px;
    width: 200px;
    border-radius: 12px;
}

/* Hudba fix naho≈ôe */
#musicButton {
    position: fixed;
    top: 20px;
    right: 20px;
    font-size: 16px;
    padding: 10px 16px;
    min-width: unset;
    z-index: 20;
}

/* Hra */
#gameContainer {
    display: none;
    width: 100%;
    text-align: center;
    margin-top: 20px;
}

#gameTitle {
    font-size: 24px;
    margin: 10px;
    background-color: #c2185b; /* tmavƒõ r≈Ø≈æov√° */
    color: white;
    padding: 8px 12px;
    border-radius: 12px;
    display: inline-block;
}

canvas {
    background: #fff;
    border-radius: 12px;
    touch-action: manipulation;
}

/* Mobiln√≠ √∫pravy */
@media (max-width: 600px) {
    .popup {
        width: 85%;
        padding: 25px;
    }

    .popup p {
        font-size: 22px;
    }

    button {
        font-size: 22px;
        padding: 18px 30px;
    }

    #introGif {
        width: 180px;
    }

    canvas {
        width: 90%;
        height: 180px;
    }
}
</style>
</head>

<body>

<!-- Popup s ot√°zkami -->
<div class="popup" id="popup">
    <p id="text">Ahoj, El√≠ku.</p>
    <button id="mainBtn" onclick="nextStep()">Ahoj?</button>
</div>

<!-- Vtipn√Ω GIF -->
<img src="eli.gif" id="introGif" alt="Vtipn√Ω GIF">

<!-- Hra -->
<div id="gameContainer">
    <div id="gameTitle">Uteƒç zl√©mu k≈ôeƒçkovi!!</div>
    <canvas id="game" width="360" height="220"></canvas>
</div>

<!-- Hudba -->
<audio id="bgMusic" src="valentyn.mp3" loop></audio>
<button id="musicButton">üéµ Hudba</button>

<script>
let step = 0;

function nextStep() {
    const t = document.getElementById("text");
    const b = document.getElementById("mainBtn");
    const gif = document.getElementById("introGif");

    if(step === 0){
        t.innerText = "Kdy≈æ u≈æ tu jsi, na nƒõco bych se chtƒõl zeptat‚Ä¶";
        b.innerText = "Tak se ptej?";
        gif.style.display = "none"; // GIF zmiz√≠ po prvn√≠ ot√°zce
    } else if(step ===1){
        t.innerText = "Byla bys‚Äì ALE NE!!";
        b.innerText = "Co se dƒõje?!";
    } else if(step ===2){
        document.getElementById("popup").style.display = "none";
        startGame();
    }
    step++;
}

/* ===== MINI HRA ===== */
const canvas = document.getElementById("game");
const ctx = canvas.getContext("2d");

// Obr√°zky
const playerImg = new Image();
playerImg.src = "elik.jpg";

const hamsterImg = new Image();
hamsterImg.src = "hamster.gif";

const fireballImg = new Image();
fireballImg.src = "fireball.png";

let player, spike, hamster, fireballs, gravity, gameOver;

function startGame(){
    document.getElementById("gameContainer").style.display = "block";
    fireballs = [];
    gravity = 0.8;
    gameOver = false;

    // Hr√°ƒç uprost≈ôed horizont√°lnƒõ
    player = {x: canvas.width/2 - 15, y: 150, w:30, h:30, vy:0};

    // K≈ôeƒçek vlevo za hr√°ƒçem a vy≈°≈°√≠ vertik√°lnƒõ
    hamster = {x: player.x - 100, y: 100, w:50, h:50, speed:1};

    // Spike
    spike = {x: 360, y: 180, w:20, h:20};

    // Projektily m√©nƒõ ƒçasto
    if(window.fireballInterval) clearInterval(window.fireballInterval);
    window.fireballInterval = setInterval(shootFireball, 2000);

    requestAnimationFrame(loop);
}

// Projektily m√≠≈ô√≠ k hr√°ƒçi, ale nikdy netref√≠
function shootFireball(){
    if(!gameOver){
        let startX = hamster.x + 40;
        let startY = hamster.y + 25;

        let dx = player.x - startX;
        let dy = player.y - startY;

        let offsetY = (Math.random()*100 -50); // n√°hodn√° odchylka
        dy += offsetY;

        let dist = Math.sqrt(dx*dx + dy*dy);
        let speed = 4;
        let vx = dx/dist * speed;
        let vy = dy/dist * speed;

        fireballs.push({x:startX, y:startY, w:15, h:15, vx:vx, vy:vy});
    }
}

function loop(){
    if(gameOver) return;

    ctx.clearRect(0,0,canvas.width, canvas.height);

    // Player physics
    player.vy += gravity;
    player.y += player.vy;
    if(player.y > 150) player.y = 150, player.vy=0;

    // Draw player
    ctx.drawImage(playerImg, player.x, player.y, player.w, player.h);

    // K≈ôeƒçek
    hamster.x += hamster.speed;
    if(hamster.x > player.x - 100) hamster.x = player.x - 100; // nikdy nep≈ôedbƒõhne
    ctx.drawImage(hamsterImg, hamster.x, hamster.y, hamster.w, hamster.h);

    // Projektily
    fireballs.forEach((f, idx)=>{
        f.x += f.vx;
        f.y += f.vy;
        ctx.drawImage(fireballImg, f.x, f.y, f.w, f.h);
        if(f.x>canvas.width || f.y>canvas.height || f.y<0) fireballs.splice(idx,1);
    });

    // Spike
    spike.x -= 4;
    if(spike.x < -20) spike.x = 360;

    ctx.fillStyle = "black";
    ctx.beginPath();
    ctx.moveTo(spike.x, spike.y);
    ctx.lineTo(spike.x+10, spike.y-20);
    ctx.lineTo(spike.x+20, spike.y);
    ctx.fill();

    // Collision spike
    if(player.x < spike.x+spike.w &&
       player.x+player.w>spike.x &&
       player.y+player.h>spike.y-20){
        endGame();
        return;
    }

    requestAnimationFrame(loop);
}

function endGame(){
    gameOver = true;
    clearInterval(window.fireballInterval);
    // Zobraz popup se zpr√°vou
    document.getElementById("popup").style.display = "block";
    document.getElementById("text").innerText = "Zem≈ôela jsi üòû";
    const b = document.getElementById("mainBtn");
    b.innerText = "Je≈°tƒõ to zkus√≠m..";
    b.onclick = ()=>{
        document.getElementById("popup").style.display = "none";
        startGame();
    }
}

// Skok ‚Äì klik / tap
canvas.addEventListener("click", ()=>{
    if(player.vy===0) player.vy=-13;
});

// Hudba ‚Äì spust√≠ se kliknut√≠m
const music = document.getElementById("bgMusic");
document.getElementById("musicButton").onclick = () => { music.play(); };
</script>

</body>
</html>